"use strict";(self.webpackChunkStore_Angular_App=self.webpackChunkStore_Angular_App||[]).push([[680],{6680:(O,y,e)=>{e.r(y),e.d(y,{LayoutModule:()=>f});var v=e(4755),d=e(2480),n=e(2223),g=e(4216),P=e(8467);function $(s,l){1&s&&(n.TgZ(0,"div",1),n._UZ(1,"mat-spinner"),n.qZA())}const S=[{path:"",component:(()=>{class s{constructor(i){this.productsStoreService=i,this.dataLoaded$=this.productsStoreService.dataLoaded$}}return s.\u0275fac=function(i){return new(i||s)(n.Y36(g.i))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-layout"]],decls:3,vars:3,consts:[["class","spinner",4,"ngIf"],[1,"spinner"]],template:function(i,F){1&i&&(n.YNc(0,$,2,0,"div",0),n.ALo(1,"async"),n._UZ(2,"router-outlet")),2&i&&n.Q6J("ngIf",!n.lcZ(1,1,F.dataLoaded$))},dependencies:[v.O5,d.lC,P.Ou,v.Ov],styles:[".spinner[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#fff;z-index:300;display:flex;align-items:center;justify-content:center}"]}),s})(),children:[{path:"",redirectTo:"store",pathMatch:"prefix"},{path:"store",loadChildren:()=>e.e(175).then(e.bind(e,2175)).then(s=>s.ProductsFeatureModule)}]}];let u=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[d.Bz.forChild(S),d.Bz]}),s})(),f=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[v.ez,u,P.Cq]}),s})()},4216:(O,y,e)=>{e.d(y,{i:()=>B});var v=e(5855),d=e(8505),n=e(4482),g=e(5403),P=e(4671),$=e(5963),A=e(8421);function S(a=1/0){let m;m=a&&"object"==typeof a?a:{count:a};const{count:t=1/0,delay:r,resetOnSuccess:c=!1}=m;return t<=0?P.y:(0,n.e)((o,h)=>{let p,C=0;const b=()=>{let E=!1;p=o.subscribe((0,g.x)(h,x=>{c&&(C=0),h.next(x)},void 0,x=>{if(C++<t){const M=()=>{p?(p.unsubscribe(),p=null,b()):E=!0};if(null!=r){const Z="number"==typeof r?(0,$.H)(r):(0,A.Xf)(r(x,C)),K=(0,g.x)(h,()=>{K.unsubscribe(),M()},()=>{h.complete()});Z.subscribe(K)}else M()}else h.error(x)})),E&&(p.unsubscribe(),p=null,b())};b()})}var u=e(262),f=e(1135),s=e(9841),l=e(4004),i=e(4128),F=e(8746),I=e(2843),L=e(2223),X=e(3144),j=e(7185),z=e(9066);let B=(()=>{class a{constructor(t,r,c){this.http=t,this.toasterService=r,this.translateService=c,this.categories$=this.http.get("https://fakestoreapi.com/products/categories").pipe((0,d.b)(o=>this.allCategories.next(o)),S(2),(0,u.K)(o=>this.handleError(o))),this.allCategories=new f.X([]),this.allCategories$=this.allCategories.asObservable(),this.products$=this.http.get("https://fakestoreapi.com/products").pipe((0,d.b)(o=>{this.adminProducts.next(o),this.productsLength=o.length}),S(2),(0,u.K)(o=>this.handleError(o))),this.dataLoaded=new f.X(!1),this.dataLoaded$=this.dataLoaded.asObservable(),this.adminProducts=new f.X([]),this.adminProducts$=this.adminProducts.asObservable(),this.productsLength=0,this.filteredProducts=new f.X([]),this.filteredProducts$=this.filteredProducts.asObservable(),this.selectedCategory=new f.X("all"),this.selectedCategory$=this.selectedCategory.asObservable(),this.mergedProductsWithCategories=(0,s.a)([this.adminProducts$,this.selectedCategory$]).pipe((0,l.U)(([o,h])=>"all"===h?o:o?.filter(p=>p.category===h)),(0,d.b)(o=>{this.filteredProducts.next(o)}),(0,u.K)(o=>this.handleError(o))),(0,i.D)([this.categories$,this.products$]).pipe((0,v.sL)(),(0,F.x)(()=>{this.dataLoaded.next(!0)}),(0,u.K)(o=>this.handleError(o))).subscribe(),this.mergedProductsWithCategories.pipe((0,v.sL)()).subscribe()}changeSelectedCategory(t){this.selectedCategory.next(t)}addProductFromApi(t){return this.http.post("https://fakestoreapi.com/products",t).pipe((0,d.b)(()=>{this.addProduct(t),this.toasterService.success(this.translateService.instant("createSuccess"))}),(0,u.K)(r=>(this.toasterService.error(this.translateService.instant("createFailed")),this.handleError(r))))}addProduct(t){this.productsLength++;const r={...t,id:this.productsLength},c=[...this.adminProducts.getValue()];c?.unshift(r),this.adminProducts.next(c)}updateProductFromApi(t){return this.http.put(`https://fakestoreapi.com/products/${t.id}`,t).pipe((0,d.b)(()=>{this.updateProduct(t),this.toasterService.success(this.translateService.instant("updatedSuccess"))}),(0,u.K)(r=>(this.toasterService.error(this.translateService.instant("updatedFailed")),this.handleError(r))))}updateProduct(t){let r=[...this.adminProducts.getValue()];const c=r.findIndex(o=>o.id===t.id);r[c]=t,r=[...r],this.adminProducts.next(r)}deleteProductFromApi(t){return this.http.delete(`https://fakestoreapi.com/products/${t}`).pipe((0,d.b)(()=>{this.deleteProduct(t),this.toasterService.success(this.translateService.instant("deleteSuccess"))}),(0,u.K)(r=>(this.toasterService.error(this.translateService.instant("deleteFailed")),this.handleError(r))))}deleteProduct(t){const c=this.adminProducts.getValue()?.filter(o=>o.id!==t);this.adminProducts.next(c)}handleError(t){let r;return r=t.error instanceof ErrorEvent?`An error occurred: ${t.error.message}`:`Backend returned code ${t.status}: ${t.body.error}`,console.error(t),(0,I._)(()=>r)}}return a.\u0275fac=function(t){return new(t||a)(L.LFG(X.eN),L.LFG(j._W),L.LFG(z.sK))},a.\u0275prov=L.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()}}]);