"use strict";(self.webpackChunkStore_Angular_App=self.webpackChunkStore_Angular_App||[]).push([[680],{6680:(M,P,e)=>{e.r(P),e.d(P,{LayoutModule:()=>l});var h=e(4755),i=e(2480),r=e(2223),u=e(3904),v=e(8467);function m(s,d){1&s&&(r.TgZ(0,"div",1),r._UZ(1,"mat-spinner"),r.qZA())}const E=[{path:"",component:(()=>{class s{constructor(n){this.productsStoreService=n,this.dataLoaded$=this.productsStoreService.dataLoaded$}}return s.\u0275fac=function(n){return new(n||s)(r.Y36(u.i))},s.\u0275cmp=r.Xpm({type:s,selectors:[["app-layout"]],decls:3,vars:3,consts:[["class","spinner",4,"ngIf"],[1,"spinner"]],template:function(n,f){1&n&&(r.YNc(0,m,2,0,"div",0),r.ALo(1,"async"),r._UZ(2,"router-outlet")),2&n&&r.Q6J("ngIf",!r.lcZ(1,1,f.dataLoaded$))},dependencies:[h.O5,i.lC,v.Ou,h.Ov],styles:[".spinner[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#fff;z-index:300;display:flex;align-items:center;justify-content:center}"]}),s})(),children:[{path:"",redirectTo:"store",pathMatch:"prefix"},{path:"store",loadChildren:()=>e.e(239).then(e.bind(e,1239)).then(s=>s.ProductsFeatureModule)}]}];let g=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=r.oAB({type:s}),s.\u0275inj=r.cJS({imports:[i.Bz.forChild(E),i.Bz]}),s})(),l=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=r.oAB({type:s}),s.\u0275inj=r.cJS({imports:[h.ez,g,v.Cq]}),s})()},3904:(M,P,e)=>{e.d(P,{i:()=>f});var h=e(5855),i=e(8505),r=e(262),u=e(1135),v=e(9841),m=e(4004),L=e(4128),E=e(8746),g=e(2843),l=e(2223),s=e(3144),d=e(7185),n=e(9066);let f=(()=>{class p{constructor(t,a,c){this.http=t,this.toasterService=a,this.translateService=c,this.categories$=this.http.get("https://fakestoreapi.com/products/categories").pipe((0,i.b)(o=>this.allCategories.next(o)),(0,r.K)(o=>this.handleError(o))),this.allCategories=new u.X([]),this.allCategories$=this.allCategories.asObservable(),this.products$=this.http.get("https://fakestoreapi.com/products").pipe((0,i.b)(o=>{this.adminProducts.next(o),this.productsLength=o.length}),(0,r.K)(o=>this.handleError(o))),this.dataLoaded=new u.X(!1),this.dataLoaded$=this.dataLoaded.asObservable(),this.adminProducts=new u.X([]),this.adminProducts$=this.adminProducts.asObservable(),this.productsLength=0,this.filteredProducts=new u.X([]),this.filteredProducts$=this.filteredProducts.asObservable(),this.selectedCategory=new u.X("all"),this.selectedCategory$=this.selectedCategory.asObservable(),this.mergedProductsWithCategories=(0,v.a)([this.adminProducts$,this.selectedCategory$]).pipe((0,m.U)(([o,C])=>"all"===C?o:o?.filter(y=>y.category===C)),(0,i.b)(o=>{this.filteredProducts.next(o)}),(0,r.K)(o=>this.handleError(o))),(0,L.D)([this.categories$,this.products$]).pipe((0,h.sL)(),(0,E.x)(()=>{this.dataLoaded.next(!0)}),(0,r.K)(o=>this.handleError(o))).subscribe(),this.mergedProductsWithCategories.pipe((0,h.sL)()).subscribe()}changeSelectedCategory(t){this.selectedCategory.next(t)}addProductFromApi(t){return this.http.post("https://fakestoreapi.com/products",t).pipe((0,i.b)(()=>{this.addProduct(t),this.toasterService.success(this.translateService.instant("createSuccess"))}),(0,r.K)(a=>(this.toasterService.error(this.translateService.instant("createFailed")),this.handleError(a))))}addProduct(t){this.productsLength++;const a={...t,id:this.productsLength},c=[...this.adminProducts.getValue()];c?.unshift(a),this.adminProducts.next(c)}updateProductFromApi(t){return this.http.put(`https://fakestoreapi.com/products/${t.id}`,t).pipe((0,i.b)(()=>{this.updateProduct(t),this.toasterService.success(this.translateService.instant("updatedSuccess"))}),(0,r.K)(a=>(this.toasterService.error(this.translateService.instant("updatedFailed")),this.handleError(a))))}updateProduct(t){let a=[...this.adminProducts.getValue()];const c=a.findIndex(o=>o.id===t.id);a[c]=t,a=[...a],this.adminProducts.next(a)}deleteProductFromApi(t){return this.http.delete(`https://fakestoreapi.com/products/${t}`).pipe((0,i.b)(()=>{this.deleteProduct(t),this.toasterService.success(this.translateService.instant("deleteSuccess"))}),(0,r.K)(a=>(this.toasterService.error(this.translateService.instant("deleteFailed")),this.handleError(a))))}deleteProduct(t){const c=this.adminProducts.getValue()?.filter(o=>o.id!==t);this.adminProducts.next(c)}handleError(t){let a;return a=t.error instanceof ErrorEvent?`An error occurred: ${t.error.message}`:`Backend returned code ${t.status}: ${t.body.error}`,console.error(t),(0,g._)(()=>a)}}return p.\u0275fac=function(t){return new(t||p)(l.LFG(s.eN),l.LFG(d._W),l.LFG(n.sK))},p.\u0275prov=l.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);